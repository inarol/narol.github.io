angular.module("ui.circleSlider",[]).directive("circleSlider",["$document","$timeout",function(n,e){return{restrict:"EA",replace:!0,scope:{options:"=circleSlider"},template:'<div class="circle" tabIndex="0">   <div class="text-wrap"><span class="text"></span></div>   <div class="handler"></div></div>',link:function(a,t,i){function o(n){var e=Math.round(x*Math.sin(n*g)),a=Math.round(x*-Math.cos(n*g)),t=n*m/360|0;b.css({left:e+x-$,top:a+x-$}),w.html(t+"&deg;")}function u(n){var a=y.offset(),t={x:n.pageX-a.left,y:n.pageY-a.top},i=Math.atan2(t.x-x,t.y-x),u=parseInt(-i/g+180);return o(u),h=e(function(){d.value=u||d.value,e.cancel(h)},30),u||d.value}function c(){f&&d.onFinish(d.value),n.unbind("mousemove",u),n.unbind("mouseup",c)}function l(n){switch(v&&d.onStart(d.value),n.keyCode){case 40:case 39:a.$applyAsync(function(){d.value=d.value++<m?d.value:0});break;case 38:case 37:a.$applyAsync(function(){d.value=d.value--<0?m:d.value})}}function s(){f&&d.onFinish(d.value)}var d=a.options,r=d.readonly,v=d.onStart,p=d.onChange,f=d.onFinish;d.value=d.value||0;var h,m=d.max||360,y=t,b=y.find(".handler"),w=y.find(".text"),x=y.width()/2,$=b.width()/2,g=Math.PI/180,M=a.$watch("options.value",function(n,e){o(d.value),n!==e&&p&&d.onChange(n)});a.$on("$destroy",function(){M()}),y.bind("mousedown",function(e){if(!r){var a=u(e);v&&d.onStart(a),n.bind("mousemove",u),n.bind("mouseup",c)}}),y.bind("keydown",l),y.bind("keyup",s)}}}]);